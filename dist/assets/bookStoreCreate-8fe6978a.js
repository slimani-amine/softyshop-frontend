import{r as m,Z as q,b as x,j as e,q as z,S as _,B as v}from"./index-043bdbd9.js";import{M as T,T as $,a as R,P as Q,b as Z,u as G}from"./leaflet-53d94262.js";import{u as H}from"./vendorApi-0bac3c3e.js";import{U as J,h as K,D as y}from"./upload-eadd2d27.js";import{F as o,R as j,C as N}from"./index-38fda43e.js";import{I as S}from"./index-10f1215d.js";import{S as V}from"./index-08eb27d4.js";import{m as C}from"./index-8ba13c34.js";import"./CheckOutlined-95f96f6c.js";async function W(r,i){const p=`https://nominatim.openstreetmap.org/reverse?lat=${r}&lon=${i}&format=json`;try{const t=await fetch(p),g=await t.json();if(t.ok){const u=g.display_name;return console.log(`The place is: ${u}`),u}else return console.error(`Error fetching data: ${t.statusText}`),null}catch{return console.error("Error fetching data: "),null}}const re=()=>{const[r]=o.useForm(),[i,p]=m.useState([""]),[t,g]=m.useState(null),[u,I]=m.useState();console.log(t);const b=[33.892166,9.561555499999997],[c,F]=m.useState(b),[M]=q(),n=x(s=>{var a;return(a=s.auth.user)==null?void 0:a.role.toLocaleUpperCase()}),k=x(s=>{var a,l;return(l=(a=s==null?void 0:s.auth)==null?void 0:a.user)==null?void 0:l.id});console.log(k),console.log(n);let d=[];if(n==="ADMIN"){const{data:s}=H();d=s==null?void 0:s.data.docs}console.log(n==="ADMIN"),console.log(d);const P=d==null?void 0:d.map(s=>({label:s.email,value:s.id})),[w,D]=m.useState(!1),O={center:c,zoom:6,style:{height:"400px",width:"100%"},attribution:"&copy; OpenStreetMap contributors"},A=({handleClick:s})=>(G({click:s}),null),U=async s=>{const{lat:a,lng:l}=s.latlng,h=await W(a,l);console.log(h),F([a,l,h]),D(!0)},E=()=>{p([...i,""])},B=s=>{const a=[...i];a.splice(s,1),p(a)},L=async()=>{try{const a={...await r.validateFields(),positionOfShop:c};console.log(a),console.log(a.positionOfShop[2]),r.resetFields();const l=a.positionOfShop[2];console.log(l);const h=M({name:a.name,phoneNumber:a.phone,logo:u,location:a.positionOfShop.splice(0,2),address:l,socialMediaLinks:a.data,vendor_id:"a0986058-3833-4a2a-b898-6a4f582d379e"});console.log(h),C.success("Shop saved successfully")}catch(s){console.log(s),console.error("Error saving shop",s),C.error("Error saving shop")}},f=x(s=>{var a;return(a=s.auth.user)==null?void 0:a.email});return console.log(f),e.jsx("div",{className:"",children:e.jsxs("div",{className:"parent-container",children:[e.jsx("h1",{className:"title",children:"Add New Shop"}),e.jsx("div",{className:"create-shop-container",children:e.jsxs(o,{form:r,className:"form-shop",children:[e.jsx(j,{gutter:[22,0],className:"name-Shop",children:e.jsx(N,{span:24,children:e.jsx(o.Item,{name:"name",style:{marginBottom:0},rules:[{required:!0,message:"Please enter Shop name"}],children:e.jsx(S,{size:"large",placeholder:"Name",className:"input-custom-small"})})})}),e.jsx(j,{gutter:[22,0],className:"name-shop",children:e.jsx(N,{span:24,children:e.jsx(o.Item,{name:"vendor",className:"select-vendor",style:{marginBottom:"20px"},children:e.jsx(V,{size:"middle",placeholder:"select-vendor",className:"input-custom",options:n==="ADMIN"?P:[],defaultValue:n==="ADMIN"?void 0:f,disabled:n!=="ADMIN"})})})}),e.jsx(j,{gutter:[16,0],className:"number-Shop",children:e.jsx(N,{span:24,children:e.jsx(o.Item,{name:"phone",style:{marginBottom:0},rules:[{required:!0,message:"Please enter Shop name"}],children:e.jsx(S,{size:"large",name:"phone",placeholder:"Shope Phone",className:"input-custom-small"})})})}),e.jsxs(T,{className:"map",...O,children:[e.jsx($,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),w&&e.jsx(R,{position:c,children:e.jsxs(Q,{children:[e.jsxs("div",{children:["Latitude: ",c[0]]}),e.jsxs("div",{children:["Longitude: ",c[1]]})]})}),e.jsx(A,{handleClick:U})]}),e.jsx(o.Item,{className:"upload-images",name:"images",rules:[{required:!0,message:"Description is required!"}],children:e.jsxs(J.Dragger,{className:"drag-images",listType:"picture",accept:"image/*",multiple:!0,maxCount:1,onChange:s=>K(s,g,I),beforeUpload:()=>!1,children:[e.jsx("p",{className:"ant-upload-text",children:"Drag & drop Shop image here"}),e.jsxs("div",{className:"icon-drag",children:[e.jsx(y,{className:"divider"}),e.jsx("p",{className:"or",children:"OR"}),e.jsx(y,{className:"divider"})]}),e.jsx(z,{className:"btn-select",children:"Select Files"}),e.jsx("p",{className:"size-img",children:"Upload 280*280 image"})]})}),e.jsxs(o.Item,{name:"dynamicInputs",children:[i.map((s,a)=>e.jsxs(_,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(o.Item,{name:["data",a],rules:[{required:!0,message:"Missing data"}],children:e.jsx(S,{className:"dynamic-input",placeholder:"Link"})}),e.jsx(Z,{onClick:()=>B(a)})]},a)),e.jsx(o.Item,{children:e.jsx(v,{className:"add-btn",onClick:E,children:e.jsx("span",{children:"Add Link"})})})]}),e.jsx(o.Item,{children:e.jsx(v,{type:"button",className:"add-cat",onClick:L,children:"Save Shop"})})]})})]})})};export{re as default};
